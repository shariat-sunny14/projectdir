{% load static %}
{% if user.is_superuser %}
<main>
    <section>
        <div class="container-fluid">
            <!-- Main Heading -->
            <div class="row">
                <div class="col col-md-4 col-md-6 dashboar-head">
                    <div class="d-sm-flex align-items-center mb-2">
                        <i class='bx bxs-window-alt text-success req-head-icon'></i>
                        <h1 class="h3 text-success req-head">Organizations Setup</h1>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--  -->
    <section>
        <div class="row row_item_setup">
            <div class="col-sm-5">
                <div class="card main-card">
                    <div class="card-body card-body_item_setup">
                        <div class="itemfilter_container">
                            <div class="filter_head">
                                <h2 class="text-warning">Filtering</h2>
                            </div>
                            <!--  -->
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="card main-card">
                                        <div class="card-body card-body_item_setup"
                                            style="display: flex; justify-content: center;">
                                            <div class="form-check form-check-inline inline_item">
                                                <input class="form-check-input radio2" type="radio" name="orgoption"
                                                    value="true" id="orgActive">
                                                <label class="form-check-label" for="orgActive">Active</label>
                                            </div>
                                            <div class="form-check form-check-inline inline_item">
                                                <input class="form-check-input radio3" type="radio" name="orgoption"
                                                    value="false" id="orgInactive">
                                                <label class="form-check-label" for="orgInactive">Inactive</label>
                                            </div>
                                            <div class="form-check form-check-inline inline_item">
                                                <input class="form-check-input radio1" type="radio" name="orgoption"
                                                    value="1" id="orgAll">
                                                <label class="form-check-label" for="orgAll">All</label>
                                            </div>
                                            <div class="form-check form-check-inline"
                                                style="position: relative; z-index: 1;">
                                                <a href="/organizations_list/"
                                                    class="btn btn-danger text-white btn-xs item_del_btn">
                                                    Clear
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  -->
                <div class="card main-card">
                    <div class="card-body card-body_item_setup">
                        <div class="itemfilter_container">
                            <div class="list_of_org">
                                <h2 class="text-success">List of Organizations</h2>
                            </div>
                            <!--  -->
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="card main-card">
                                        <div class="card-body card-body_item_setup">
                                            <!--  -->
                                            <div class="type_type">
                                                <table id="" class="table table-hover" class="table table-striped"
                                                    style="width: 100%;">
                                                    <thead class="text-center table-header_itemlist">
                                                        <tr>
                                                            <th style="text-align:center; width: 20%;">Org. No.</th>
                                                            <th style="text-align:center; width: 60%;">Organization Name
                                                            </th>
                                                            <th style="text-align:center; width: 15%;">Status</th>
                                                        </tr>
                                                        <tr>
                                                            <th colspan="4"
                                                                style="text-align:center; background: #fff !important;">
                                                                <input type="search" id="storesearch"
                                                                    class="form-control search_control item_inputbox"
                                                                    style="margin-left: 4px; background:#fffab6;"
                                                                    placeholder="Searching ..." autocomplete="off">
                                                            </th>
                                                        </tr>
                                                    </thead>

                                                    <tbody id="org_filter_body" class="table-body-row"
                                                        style="text-align:center; cursor: pointer;">

                                                    </tbody>
                                                    <!-- loader start -->
                                                    <section class="loader-section">
                                                        <div class="loader-body">
                                                            <div class="loader">
                                                                <div class="upper ball"></div>
                                                                <div class="right ball"></div>
                                                                <div class="lower ball"></div>
                                                                <div class="left ball"></div>
                                                            </div>
                                                        </div>
                                                    </section>
                                                    <!-- loader end -->
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--  -->
            <div class="col-sm-7" id="form1" name="form1">
                <div class="card main-card">
                    <div class="card-body card-body_item_setup">
                        <div class="itemsetup_container">
                            <form action="" method="" id="org_form" enctype="multipart/form-data">
                                <input type="hidden" id="id_org_id" name="org_id" value="">
                                <div class="add_edit_head">
                                    <h2 class="text-primary">Add/Update Organizations Information</h2>
                                </div>
                                <!--  -->
                                <div class="row row_item_setup">
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_org_setup">
                                                <div class="row row_item_setup" style="display: flex; flex-direction: row-reverse; flex-wrap: wrap; justify-content: flex-start; align-items: center; align-content: center;">
                                                    <div class="col-isactive">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="item_setupflag"
                                                                    style="display: flex; justify-content: right;">
                                                                    <label
                                                                        class="form-check-label text-danger setupflag_label"
                                                                        for="id_is_active">
                                                                        Active?
                                                                    </label>
                                                                    <input class="form-check-input" type="checkbox"
                                                                        id="id_is_active" name="is_active" value="1"
                                                                        aria-label="...">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--  -->
                                                    <div class="col-sm-4">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="item_setupflag"
                                                                    style="display: flex; justify-content: right;">
                                                                    <label
                                                                        class="form-check-label setupflag_label"
                                                                        for="id_ser_char_alert">
                                                                        Service Charge Alerts?
                                                                    </label>
                                                                    <input class="form-check-input" type="checkbox"
                                                                        id="id_ser_char_alert" name="ser_char_alert" value="1"
                                                                        aria-label="...">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--  -->
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_org_setup">
                                                <div class="row row_item_setup">
                                                    <div class="col-sm-4">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="row cash_point_row div_id_org_no">
                                                                    <label for="id_org_no"
                                                                        class="col-sm-41 col-form-label font_size_filter required">
                                                                        Org. No:
                                                                    </label>
                                                                    <div class="col-sm-6">
                                                                        <input type="text"
                                                                            class="form-control item_inputbox"
                                                                            id="id_org_no" name="org_no"
                                                                            autocomplete="off" required>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--  -->
                                                    <div class="col-sm-4">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="row cash_point_row">
                                                                    <label for="id_start_up"
                                                                        class="col-sm-32 col-form-label font_size_filter required">
                                                                        Start Up:
                                                                    </label>
                                                                    <div class="col-sm-7">
                                                                        <input type="text" style="text-align: center;"
                                                                            class="form-control item_inputbox datepicker"
                                                                            id="id_start_up" name="start_up"
                                                                            autocomplete="off" required>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--  -->
                                                    <div class="col-sm-4">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="row cash_point_row">
                                                                    <label for="id_service_charge"
                                                                        class="col-sm-41 col-form-label font_size_filter required">
                                                                        Ser. Charge:
                                                                    </label>
                                                                    <div class="col-sm-58">
                                                                        <input type="number" style="text-align: center;"
                                                                            class="form-control item_inputbox"
                                                                            id="id_service_charge" name="service_charge"
                                                                            autocomplete="off" required>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--  -->
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_org_setup">
                                                <div class="row row_item_setup">
                                                    <div class="col-sm-12">
                                                        <div class="card main-card">
                                                            <div class="card-body item_setup_sub">
                                                                <div class="row cash_point_row div_id_org_name">
                                                                    <label for="id_org_name"
                                                                        class="col-sm-orgName col-form-label font_size_filter required">
                                                                        Org. Name:
                                                                    </label>
                                                                    <div class="col-orgNameInput">
                                                                        <input type="text"
                                                                            class="form-control item_inputbox"
                                                                            id="id_org_name" name="org_name"
                                                                            autocomplete="off" required>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--  -->
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_item_setup">
                                                <div class="itemsetup_container">
                                                    <div class="others_info_head">
                                                        <h2 class="text-danger">Service Alert Date Info</h2>
                                                    </div>
                                                    <!--  -->
                                                    <div class="row row_item_setup" style="margin-bottom: 1rem;">
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row">
                                                                                        <label for="id_alert_start"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Alert Start:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="number" style="text-align: center;"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_alert_start" name="alert_start" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_alert_end"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Alert End:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="number" style="text-align: center;"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_alert_end" name="alert_end" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> 
                                    </div>
                                    <!-- Notification Access Info -->
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_item_setup">
                                                <div class="itemsetup_container">
                                                    <div class="access_info_head">
                                                        <h2 class="text-warning">Module Wise Notification Access Info</h2>
                                                    </div>
                                                    <!--  -->
                                                    <div class="row row_item_setup" style="margin-bottom: 1rem;">
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_delivery_chalan" name="is_delivery_chalan" value="1"
                                                                                            aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_delivery_chalan">
                                                                                            Is Delivery Chalan
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_grn" name="is_grn" value="1"
                                                                                            aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_grn">
                                                                                            Is Good Receive Note (GRN)
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_lp" name="is_lp" value="1"
                                                                                            aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_lp">
                                                                                            Is Local Purchase (LP)
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_mrr" name="is_mrr" value="1"
                                                                                            aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_mrr">
                                                                                            Is Manual Return Receive
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_store_trans" name="is_store_trans" value="1"
                                                                                            aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_store_trans">
                                                                                            Is Store Transfer
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-4">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag" style="display: flex; justify-content: flex-start; align-items: center;">
                                                                                        <input class="form-check-input" type="checkbox" style="margin-top: 0em;"
                                                                                            id="id_is_stock_recon" name="is_stock_recon" value="1" aria-label="...">
                                                                                        <label style="margin-left: 5px;"
                                                                                            class="form-check-label setupflag_label"
                                                                                            for="id_is_stock_recon">
                                                                                            Is Stock Reconciliation
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> 
                                    </div>
                                    <!--  -->
                                    <div class="col-sm-12">
                                        <div class="card main-card">
                                            <div class="card-body card-body_item_setup">
                                                <div class="itemsetup_container">
                                                    <div class="others_info_head">
                                                        <h2 class="text-info">Others Information</h2>
                                                    </div>
                                                    <!--  -->
                                                    <div class="row row_item_setup">
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_country">
                                                                                        <label for="id_country"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Country:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <select id="id_country" name="country"
                                                                                                class="form-select item_inputbox"
                                                                                                aria-label="Default select example">
                                                                                                <option value="" selected disabled>Choose Country ...</option>
                                                                                                {% for count in countries %}
                                                                                                <option value="{{count.lookup_id}}">
                                                                                                    {{ count.name }}
                                                                                                </option>
                                                                                                {% endfor %}
                                                                                            </select>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag div_id_division"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_division"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Division:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <select id="id_division" name="division"
                                                                                                class="form-select item_inputbox"
                                                                                                aria-label="Default select example">
                                                                                                <option value="" selected disabled>Choose Division ...</option>
                                                                                                {% for divis in divisions %}
                                                                                                <option value="{{divis.lookup_id}}">
                                                                                                    {{ divis.name }}
                                                                                                </option>
                                                                                                {% endfor %}
                                                                                            </select>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_district">
                                                                                        <label for="id_district"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            District:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <select id="id_district" name="district"
                                                                                                class="form-select item_inputbox"
                                                                                                aria-label="Default select example">
                                                                                                <option value="" selected disabled>Choose District ...</option>
                                                                                                {% for dist in districts %}
                                                                                                <option value="{{dist.lookup_id}}">
                                                                                                    {{ dist.name }}
                                                                                                </option>
                                                                                                {% endfor %}
                                                                                            </select>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag div_id_upazila"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_upazila"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Upazila:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <select id="id_upazila" name="upazila"
                                                                                                class="form-select item_inputbox"
                                                                                                aria-label="Default select example">
                                                                                                <option value="" selected disabled>Choose Upazila ...</option>
                                                                                                {% for upazila in upazilas %}
                                                                                                <option value="{{upazila.lookup_id}}">
                                                                                                    {{ upazila.name }}
                                                                                                </option>
                                                                                                {% endfor %}
                                                                                            </select>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_email">
                                                                                        <label for="id_email"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Email:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="email"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_email" name="email" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag div_id_fax"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_fax"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Fax:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="number"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_fax" name="fax" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_website">
                                                                                        <label for="id_website"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Website:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="text"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_website" name="website" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag div_id_hotline"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_hotline"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Hotline:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="number"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_hotline" name="hotline" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_phone">
                                                                                        <label for="id_phone"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Phone:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <input type="number"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_phone" name="phone" autocomplete="off">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--  -->
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div class="item_setupflag div_id_org_logo"
                                                                                        style="display: flex; justify-content: right;">
                                                                                        <label for="id_logo"
                                                                                            class="col-sm-3 col-form-label font_size_filter">
                                                                                            Logo:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <!-- logo -->
                                                                                            <div class="profile-container px-4">
                                                                                                <div class="row gx-5 user-profile">
                                                                                                    <div class="col user-profile-img">
                                                                                                        <div class="user-img">
                                                                                                            <div class="profile-pic">
                                                                                                                <div id="display_image">
                                                                                                                    <img class="img-viewer" id="selected_logo" src="{% static 'images/profile_img/user.png' %}">
                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <div class="form-row field-profile_img profile-icon">
                                                                                                                <div>
                                                                                                                    <label for="id_org_logo">
                                                                                                                        <i class="bx bxs-camera profile-upload-icon"></i>
                                                                                                                    </label>
                                                                                                                    <input type="file" name="org_logo" accept="image/*" id="id_org_logo" style="display:none;"
                                                                                                                        onchange="displaySelectedLogo(this);">
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            <!-- logo -->
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12" style="margin-bottom: 0.5rem;">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-6">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_address">
                                                                                        <label for="id_address"
                                                                                            class="col-sm-3modify col-form-label font_size_filter">
                                                                                            Address:
                                                                                        </label>
                                                                                        <div class="col-sm-9">
                                                                                            <textarea type="text"
                                                                                                class="form-control item_inputbox"
                                                                                                id="id_address"
                                                                                                name="address"
                                                                                                autocomplete="off"></textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--  -->
                                                        <div class="col-sm-12" style="margin-bottom: 1rem;">
                                                            <div class="card main-card">
                                                                <div class="card-body card-body_org_setup">
                                                                    <div class="row row_item_setup">
                                                                        <div class="col-sm-12">
                                                                            <div class="card main-card">
                                                                                <div class="card-body item_setup_sub">
                                                                                    <div
                                                                                        class="row cash_point_row div_id_description">
                                                                                        <label for="id_description"
                                                                                            class="col-sm-label_mody col-form-label font_size_filter">
                                                                                            Description:
                                                                                        </label>
                                                                                        <div class="col-sm-10modify">
                                                                                            <textarea type="text" class="form-control item_inputbox"
                                                                                                id="id_description" name="description" 
                                                                                                autocomplete="off"></textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- submit button -->
                                <div class="submit_button">
                                    <button type="button" class="btn btn-primary btn-sm" onClick="navigateTo('/organizations_list/')"
                                        style="margin-right: 10px;">
                                        Add New
                                    </button>
                                    <button type="button" class="btn btn-danger btn-sm" style="margin-right: 10px;"
                                        onclick="clearFormAndImage();">
                                        Clear
                                    </button>
                                    <button type="submit" value="submit" class="btn btn-success btn-sm"
                                        style="margin-right: 10px;">
                                        Save & Update
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
{% else %}
<div class="container" style="margin-top: 5rem;">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="alert alert-warning text-center" role="alert">
                You do not have permission to access this page.
            </div>
        </div>
    </div>
</div>
{% endif %}
<script>
    $(document).ready(function () {
        // Define a function to populate the table with data
        function org_populateTable(data) {

            // org history
            for (var i = 0; i < data.org_Dtls.length; i++) {
                var org_data = data.org_Dtls[i];

                var org_id = org_data.org_id;
                var org_no = org_data.org_no;
                var org_name = org_data.org_name;
                var start_up = org_data.start_up;
                var service_charge = org_data.service_charge;
                var alert_start = org_data.alert_start;
                var alert_end = org_data.alert_end;
                var is_active = org_data.is_active;
                var ser_char_alert = org_data.ser_char_alert;
                var is_delivery_chalan = org_data.is_delivery_chalan;
                var is_grn = org_data.is_grn;
                var is_lp = org_data.is_lp;
                var is_mrr = org_data.is_mrr;
                var is_store_trans = org_data.is_store_trans;
                var is_stock_recon = org_data.is_stock_recon;
                var country = org_data.country;
                var division = org_data.division;
                var district = org_data.district;
                var upazila = org_data.upazila;
                var email = org_data.email;
                var fax = org_data.fax;
                var website = org_data.website;
                var hotline = org_data.hotline;
                var phone = org_data.phone;
                var org_logo = org_data.org_logo;
                var address = org_data.address;
                var description = org_data.description;

                // Get the checkbox input element by its ID
                var is_activeCheckbox = document.getElementById("id_is_active");
                var ser_char_alertCheckbox = document.getElementById("id_ser_char_alert");
                var is_delivery_chalanCheckbox = document.getElementById("id_is_delivery_chalan");
                var is_grnCheckbox = document.getElementById("id_is_grn");
                var is_lpCheckbox = document.getElementById("id_is_lp");
                var is_mrrCheckbox = document.getElementById("id_is_mrr");
                var is_store_transCheckbox = document.getElementById("id_is_store_trans");
                var is_stock_reconCheckbox = document.getElementById("id_is_stock_recon");

                // Set the checked attribute based on the is_active value
                is_activeCheckbox.checked = is_active;
                ser_char_alertCheckbox.checked = ser_char_alert;
                is_delivery_chalanCheckbox.checked = is_delivery_chalan;
                is_grnCheckbox.checked = is_grn;
                is_lpCheckbox.checked = is_lp;
                is_mrrCheckbox.checked = is_mrr;
                is_store_transCheckbox.checked = is_store_trans;
                is_stock_reconCheckbox.checked = is_stock_recon;

                $("#id_org_id").val(org_id);
                $("#id_org_no").val(org_no);
                $("#id_org_name").val(org_name);
                $("#id_start_up").val(start_up);
                $("#id_service_charge").val(service_charge);
                $("#id_alert_start").val(alert_start);
                $("#id_alert_end").val(alert_end);
                $("#id_country").val(country);
                $("#id_division").val(division);
                $("#id_district").val(district);
                $("#id_upazila").val(upazila);
                $("#id_email").val(email);
                $("#id_fax").val(fax);
                $("#id_website").val(website);
                $("#id_hotline").val(hotline);
                $("#id_phone").val(phone);
                $("#selected_logo").attr("src", org_logo);
                $("#id_address").val(address);
                $("#id_description").val(description);

                console.log("Org_list:", org_data);
            }
        }

        // Fetch data from your Django view using AJAX
        $(document).on("click", ".org_editBtn", function () {
            var orgID = $(this).data("org-id"); // Get the item_id from the data attribute

            $.ajax({
                type: "GET",
                url: "/get_organization_lists/" + orgID + "/",
                dataType: "json",
                success: function (data) {
                    org_populateTable(data);
                },
                error: function (xhr, status, error) {
                    console.log("AJAX Error:", error);
                    toastr.warning("Failed to fetch Store details");
                }
            });
        });

    });

    //<!--  -->
    $(document).ready(function () {
        // Load initial data based on the initially checked radio button
        loadInitialOrgData();
        handleOrgRowSelection();

        // Add event listeners to radio buttons
        $('input[name="orgoption"]').change(function () {
            var option = $(this).val();

            // Save the selected option to local storage
            localStorage.setItem('orglistOption', option);

            // Load items
            loadOrglist();
        });

        // Load items based on the search query
        loadOrgFromSearch();

        // Function to load items based on the search query
        function loadOrgFromSearch() {
            // Get the search query from local storage if it exists
            var savedOrgsearchQuery = localStorage.getItem("OrgsearchQuery");
            var orgListsearch = $('#storesearch');

            // Check if there's a saved search query
            if (savedOrgsearchQuery) {
                // Set the search input value
                orgListsearch.val(savedOrgsearchQuery);
            }

            // Add an event listener to the search input field
            orgListsearch.on('input', function () {
                var query = $(this).val();
                localStorage.setItem("OrgsearchQuery", query);
                loadOrglist();
            });

            // Trigger the search on page load
            loadOrglist();
        }

        function loadInitialOrgData() {
            // Retrieve the selected option from local storage
            var storeinitialOption = localStorage.getItem('orglistOption') || 'true';

            // Check the corresponding radio button
            $('input[name="orgoption"][value="' + storeinitialOption + '"]').prop('checked', true);

            // Load items
            loadOrglist();
        }

        function loadOrglist() {
            // Get the current search query and option from local storage
            var OrgsearchQuery = localStorage.getItem("OrgsearchQuery") || '';
            var orgoption = localStorage.getItem('orglistOption') || 'true';

            // Make Ajax request
            $.ajax({
                type: 'GET',
                url: '/get_list_of_organization/',
                data: {
                    'orgoption': orgoption,
                    'org_search_query': OrgsearchQuery
                },
                success: function (data) {
                    // Update the table with filtered data
                    updateOrgTable(data);
                },
                error: function (xhr, status, error) {
                    console.log('Ajax Error:', xhr.responseText);
                    console.log('Status:', status);
                    console.log('Error:', error);
                }
            });
        }

        function updateOrgTable(data) {
            var tableBody = $('#org_filter_body');
            tableBody.empty();

            if (data.data && data.data.length === 0) {
                $('#noDataFoundRow').show();
            } else {
                $('#noDataFoundRow').hide();

                if (data.data) {
                    $.each(data.data, function (index, org) {
                        var statusText = org.is_active ? 'Active' : 'Inactive';
                        var statusClass = org.is_active ? 'active-status' : 'inactive-status';

                        tableBody.append(`<tr class="org_editBtn" data-org-id="${org.org_id}">
                            <td style="text-align: center;">${org.org_no}</td>
                            <td style="text-align: left;">${org.org_name}</td>
                            <td class="status_act_inac ${statusClass}" style="text-align: center;">${statusText}</td>
                        </tr>`);
                    });
                }
            }
            // Check if there is a selected item ID in local storage and highlight the row
            handleOrgRowSelection();
        }

        $(function () {
            $('#org_form').submit(function (e) {
                e.preventDefault();
                var formData = new FormData($(this)[0]);

                $.ajax({
                    headers: {
                        "X-CSRFToken": '{{csrf_token}}'
                    },
                    url: "{% url 'org_add_update' %}",
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    method: 'POST',
                    type: 'POST',
                    dataType: 'json',
                    success: function (resp) {
                        if (success = resp.msg) {
                            toastr.success(resp.msg);
                            loadOrglist();
                            showOrgLoader();
                            // clear form and img
                            clearFormAndImage();
                            // Hide loader
                            setTimeout(function () {hideOrgLoader();}, 1100);

                        } else {
                            toastr.error(resp.errmsg);
                        }
                    }
                });
            });
        });
    });

    function handleOrgRowSelection() {
        // Check if there is a selected item ID in local storage and highlight the row
        var selectedStoreID = localStorage.getItem("selectedStoreID");
        if (selectedStoreID) {
            $(".org_editBtn").removeClass("selected-row");
            $(".org_editBtn[data-org-id='" + selectedStoreID + "']").addClass("selected-row");
        }

        // Add an event listener to the item rows
        $(document).on("click", ".org_editBtn", function () {
            var clickedStoreID = $(this).data("org-id");
            $(".org_editBtn").removeClass("selected-row");
            $(this).addClass("selected-row");

            // Save the selected item ID to local storage
            localStorage.setItem("selectedStoreID", clickedStoreID);
        });
    }


    // clear form and img
    function clearFormAndImage() {
        // Reset the form with ID 'org_form'
        $('#org_form')[0].reset();
        $('#id_org_id').val('');
        // Set the source of the image with ID 'selected_logo' to the default image path
        $('#selected_logo').attr('src', '{% static "images/profile_img/user.png" %}');
    }

    //==========================================
    //loader 
    const loader = document.querySelector(".loader");
    const loaderBody = document.querySelector(".loader-body");

    // Function to show the loader
    function showOrgLoader() {
        loader.style.display = "block";
        loaderBody.style.display = "block";
        loader.style.left = "50%"; // Set left position to center
        loader.style.top = "50%"; // Set top position to center
    }

    // Function to hide the loader
    function hideOrgLoader() {
        loader.style.display = "none";
        loaderBody.style.display = "none";
    }

    // Function to check and show loader based on local storage
    function checkAndOrgShowLoader() {
        const loaderOrgVisible = localStorage.getItem("loaderOrgVisible");
        if (loaderOrgVisible === "true") {
            showOrgLoader();
        }
    }

    // Event listener for radio button change
    document.querySelectorAll('input[name="orgoption"]').forEach(radio => {
        radio.addEventListener('change', function () {
            showOrgLoader(); // Show loader when radio button changes
            // Add logic to handle the radio button change if needed
            setTimeout(() => {
                hideOrgLoader(); // Hide loader after a delay (you can adjust this)
            }, 1100); // Example: hide loader after 2 seconds
        });
    });

    // Check and show loader on page load
    checkAndOrgShowLoader();

    window.addEventListener("load", () => {
        // Adjust the delay in milliseconds (e.g., 2000 for 2 seconds)
        setTimeout(() => {
            hideOrgLoader();
        }, 1100);
    });
    //loader
    //==========================================

    // image load in the page
    function displaySelectedLogo(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
    
            reader.onload = function (e) {
                var img = new Image();
                img.src = e.target.result;
    
                img.onload = function () {
                    var canvas = document.createElement('canvas');
                    var ctx = canvas.getContext('2d');
    
                    var maxWidth = 300;
                    var maxHeight = 300;
    
                    var width = img.width;
                    var height = img.height;
    
                    if (width > maxWidth || height > maxHeight) {
                        if (width > height) {
                            height *= maxWidth / width;
                            width = maxWidth;
                        } else {
                            width *= maxHeight / height;
                            height = maxHeight;
                        }
    
                        canvas.width = width;
                        canvas.height = height;
    
                        ctx.drawImage(img, 0, 0, width, height);
    
                        // Create or select the element with ID 'selected_logo'
                        var selectedLogo = document.getElementById('selected_logo');
                        if (!selectedLogo) {
                            selectedLogo = new Image();
                            selectedLogo.id = 'selected_logo';
                            document.body.appendChild(selectedLogo); // Append the image to the body or any other appropriate container
                        }
    
                        // Set the image source to the resized image
                        selectedLogo.src = canvas.toDataURL('image/jpeg');
    
                        // Check if image size exceeds 300x300 after resizing
                        if (width > maxWidth || height > maxHeight) {
                            toastr.warning('Image size should be within 300x300 pixels.');
                        }
                    } else {
                        // If the image is within the size limit, set the image source directly
                        var selectedLogo = document.getElementById('selected_logo');
                        if (selectedLogo) {
                            selectedLogo.src = img.src;
                        }
                    }
                };
            };
    
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>